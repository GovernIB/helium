{
  "openapi": "3.0.3",
  "info": {
    "title": "HeliumMS Dominis API",
    "description": "Microservei de Dominis de HeliumMS",
    "contact": {
      "name": "Limit Tecnologies",
      "email": "limit@limit.es"
    },
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "http://pendent.de.definir.es",
      "description": "Servidor de desenvolupament"
    }
  ],
  "tags": [
    {
      "name": "Disseny",
      "description": "Operacions securitzades disponibles per usuaris dissenyadors"
    },
    {
      "name": "Consulta",
      "description": "Operacions disponibles per tots els usuaris"
    }
  ],
  "paths": {
    "/api/v1/dominis": {
      "get": {
        "tags": [
          "Disseny",
          "Consulta"
        ],
        "summary": "Cerca de dominis",
        "description": "Obté una página de la cerca dels **dominis** del sistema.\n\nLa cerca pot rebre paràmetres per\n- ordenar\n- paginar\n- filtrar (utilitzant sintaxi rsql)\n",
        "operationId": "listDominisV1",
        "parameters": [
          {
            "name": "entornId",
            "in": "query",
            "description": "Identificador de l'entorn",
            "required": true,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "filtre",
            "in": "query",
            "description": "cadena amb format rsql per a definir el filtre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "expedientTipusId",
            "in": "query",
            "description": "Identificador del tipus d'expedient al que pertany el domini",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "expedientTipusPareId",
            "in": "query",
            "description": "Identificador del tipus d'expedient pare al que pertany el domini (en cas d\\'herència)",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "número de pagina a retornar en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "mida de la pàgina a retornat en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 25
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "ordre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DominiPagedList"
                }
              }
            }
          },
          "204": {
            "description": "No content"
          },
          "400": {
            "description": "Bad input parameter"
          }
        }
      },
      "post": {
        "tags": [
          "Disseny"
        ],
        "summary": "Crea un nou domini",
        "description": "Afegiex un nou domini al sistema",
        "operationId": "createDominiV1",
        "requestBody": {
          "description": "Domini a crear",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Domini"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Domini created",
            "headers": {
              "Location": {
                "description": "Adressa del domini creat",
                "style": "simple",
                "explode": false,
                "schema": {
                  "type": "string",
                  "format": "uri",
                  "example": "http://example.com/v1/dominis/{assignedIdValue}"
                }
              }
            }
          },
          "400": {
            "description": "Bad request"
          },
          "409": {
            "description": "Conflicte. Ja existeix el domini"
          }
        }
      }
    },
    "/api/v1/dominis/{dominiId}": {
      "get": {
        "tags": [
          "Disseny",
          "Consulta"
        ],
        "summary": "Consulta un domini donat el seu identificador",
        "description": "Retorna les dades del domini amb l'identificador informat al paràmetre `dominiId`",
        "operationId": "getDominiV1",
        "parameters": [
          {
            "name": "dominiId",
            "in": "path",
            "description": "Identificador del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Domini"
                }
              }
            }
          },
          "404": {
            "description": "Not found"
          }
        }
      },
      "put": {
        "tags": [
          "Disseny"
        ],
        "summary": "Modifica un domini donat el seu identificador",
        "description": "Modifica el domini amb l'identificador passat al paràmetre `dominiId`, amb les totes dades de l'objecte Domini passat al body de la petició",
        "operationId": "updateDominiV1",
        "parameters": [
          {
            "name": "dominiId",
            "in": "path",
            "description": "Identificador del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Domini"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Domini actualitzat"
          },
          "404": {
            "description": "Not found"
          },
          "409": {
            "description": "Conflicte"
          }
        }
      },
      "delete": {
        "tags": [
          "Disseny"
        ],
        "summary": "Elimina un domini donat el seu identificador",
        "description": "Elimina el domini amb l'identificador passat al paràmetre `dominiId`",
        "operationId": "deleteDominiV1",
        "parameters": [
          {
            "name": "dominiId",
            "in": "path",
            "description": "Identificador del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok"
          },
          "404": {
            "description": "Not found"
          }
        }
      },
      "patch": {
        "tags": [
          "Disseny"
        ],
        "summary": "Actualitza camps concrets d'un domini donat el seu identificador",
        "description": "Modifica els camps del domini amb l'identificador passat al paràmetre `dominiId`, amb els camps de l'objecte Domini passat al body de la petició.  \nNomés modifica els camps informats en l'objecte. Els camps no inclosos en l'objecte no seran modificats.\n",
        "operationId": "patchDominiV1",
        "parameters": [
          {
            "name": "dominiId",
            "in": "path",
            "description": "Identificador del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Domini"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Domini actualitzat"
          },
          "404": {
            "description": "Not found"
          },
          "409": {
            "description": "Conflicte"
          }
        }
      }
    },
    "/api/v1/dominis/{dominiId}/resultats": {
      "get": {
        "tags": [
          "Consulta"
        ],
        "summary": "Consulta un domini",
        "description": "Realitza la consulta del domini amb l'identificador passat al paràmetre `dominiId`.  \nPer a realitzar la consulta utilitza la configuració del domini, juntament amb els paràmetres passats.  \nEls paràmetres es passaran com un mapa amb la clau de tipus string, i un valor de tipus objecte\n",
        "operationId": "consultaDominiV1",
        "parameters": [
          {
            "name": "dominiId",
            "in": "path",
            "description": "Identificador del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "identificador",
            "in": "query",
            "description": "identificador del domini al sistema remot",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "parametres",
            "in": "query",
            "description": "Map<String, Object> amb els paràmetres que es volen passar en la consulta del domini",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "object",
              "additionalProperties": true,
              "example": {
                "codi1": "Valor1",
                "codi2": "Valor2"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResultatDomini"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/entorn/{entornId}/dominis": {
      "get": {
        "tags": [
          "Consulta"
        ],
        "summary": "Consulta un domini",
        "description": "Obté una pàgina de la cerca dels **dominis** d'un entorn.\n\nLa cerca pot rebre paràmetres per\n- ordenar\n- paginar\n- filtrar (utilitzant sintaxi rsql)\n\nNo té en compte la herència\n",
        "operationId": "llistaDominiByEntorn",
        "parameters": [
          {
            "name": "entornId",
            "in": "path",
            "description": "Identificador de l'entorn",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "filtre",
            "in": "query",
            "description": "cadena amb format rsql per a definir el filtre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "número de pagina a retornar en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "mida de la pàgina a retornat en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 25
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "ordre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DominiPagedList"
                }
              }
            }
          },
          "204": {
            "description": "No content"
          },
          "400": {
            "description": "Bad input parameter"
          }
        }
      }
    },
    "/api/v1/entorn/{entornId}/dominis/{codi}": {
      "get": {
        "tags": [
          "Consulta"
        ],
        "summary": "Consulta un domini d'un tipus d'expedient",
        "description": "Obté el domini de tipus d'expedient donat el tipus d'expedient al que pertany, i el seu codi.\nEn cas d'informar el tipus d'expedient pare es tindrà en compte la herència\n",
        "operationId": "getDominiByEntornAndCodi",
        "parameters": [
          {
            "name": "entornId",
            "in": "path",
            "description": "Identificador de l'entorn",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "codi",
            "in": "path",
            "description": "Codi del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "expedientTipusPareId",
            "in": "query",
            "description": "Identificador del tipus d'expedient pare al que pertany el domini (en cas d\\'herència)",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Domini"
                }
              }
            }
          },
          "204": {
            "description": "No content"
          },
          "400": {
            "description": "Bad input parameter"
          }
        }
      }
    },
    "/api/v1/expedientTipus/{expedientTipusId}/dominis": {
      "get": {
        "tags": [
          "Consulta"
        ],
        "summary": "Consulta un domini",
        "description": "Obté una pàgina de la cerca dels **dominis** d'un entorn.\n\nLa cerca pot rebre paràmetres per\n- ordenar\n- paginar\n- filtrar (utilitzant sintaxi rsql)\n\nNo té en compte la herència\n",
        "operationId": "llistaDominiByExpedientTipus",
        "parameters": [
          {
            "name": "expedientTipusId",
            "in": "path",
            "description": "Identificador del tipus d'expedient",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "filtre",
            "in": "query",
            "description": "cadena amb format rsql per a definir el filtre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "número de pagina a retornar en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 0
            }
          },
          {
            "name": "size",
            "in": "query",
            "description": "mida de la pàgina a retornat en cas de desitjar paginació",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "minimum": 0,
              "type": "integer",
              "format": "int32",
              "default": 25
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "ordre a aplicar a la consulta",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DominiPagedList"
                }
              }
            }
          },
          "204": {
            "description": "No content"
          },
          "400": {
            "description": "Bad input parameter"
          }
        }
      }
    },
    "/api/v1/expedientTipus/{expedientTipusId}/dominis/{codi}": {
      "get": {
        "tags": [
          "Consulta"
        ],
        "summary": "Consulta un domini d'un tipus d'expedient",
        "description": "Obté el domini de tipus d'expedient donat el tipus d'expedient al que pertany, i el seu codi.\nEn cas d'informar el tipus d'expedient pare es tindrà en compte la herència\n",
        "operationId": "getDominiByExpedientTipusAndCodi",
        "parameters": [
          {
            "name": "expedientTipusId",
            "in": "path",
            "description": "Identificador del tipus d'expedient",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "codi",
            "in": "path",
            "description": "Codi del domini",
            "required": true,
            "style": "simple",
            "explode": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "expedientTipusPareId",
            "in": "query",
            "description": "Identificador del tipus d'expedient pare al que pertany el domini (en cas d\\'herència)",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Domini"
                }
              }
            }
          },
          "204": {
            "description": "No content"
          },
          "400": {
            "description": "Bad input parameter"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Domini": {
        "required": [
          "codi",
          "nom"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "readOnly": true,
            "example": 1234
          },
          "codi": {
            "maxLength": 64,
            "type": "string",
            "example": "codi_domini"
          },
          "nom": {
            "maxLength": 255,
            "type": "string",
            "example": "nom_domini"
          },
          "tipus": {
            "type": "string",
            "example": "CONSULTA_REST",
            "enum": [
              "CONSULTA_SQL",
              "CONSULTA_WS",
              "CONSULTA_REST"
            ]
          },
          "url": {
            "maxLength": 255,
            "type": "string",
            "format": "uri",
            "example": "http://example.com/nom_domini"
          },
          "tipusAuth": {
            "type": "string",
            "example": "HTTP_BASIC",
            "enum": [
              "NONE",
              "HTTP_BASIC",
              "USERNAMETOKEN"
            ]
          },
          "origenCredencials": {
            "type": "string",
            "example": "PROPERTIES",
            "enum": [
              "ATRIBUTS",
              "PROPERTIES"
            ]
          },
          "usuari": {
            "maxLength": 255,
            "type": "string",
            "example": "codi_usuari"
          },
          "contrasenya": {
            "maxLength": 255,
            "type": "string",
            "format": "password",
            "example": "password"
          },
          "sql": {
            "maxLength": 1024,
            "type": "string",
            "example": "select camp_1, camp_2, camp_3 from taula where camp_4 = :parametre"
          },
          "jndiDatasource": {
            "maxLength": 255,
            "type": "string",
            "example": "java:/es.caib.example.db"
          },
          "descripcio": {
            "maxLength": 255,
            "type": "string",
            "example": "Text descriptiu del domini"
          },
          "cacheSegons": {
            "type": "integer",
            "description": "En cas de posar el valor 0 ???"
          },
          "timeout": {
            "type": "integer",
            "description": "En cas de posar el valor 0 ???"
          },
          "ordreParams": {
            "maxLength": 255,
            "type": "string"
          },
          "entorn": {
            "type": "integer",
            "description": "Identificador de l'entorn al que pertany el domini",
            "format": "int64"
          },
          "expedientTipus": {
            "type": "integer",
            "description": "Identificador del tipus d'expedient al que pertany el domini. Si el domini és global aquest identificador serà null.",
            "format": "int64"
          }
        }
      },
      "ResultatDomini": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/FilaResultat"
        }
      },
      "FilaResultat": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/ParellaCodiValor"
        }
      },
      "ParellaCodiValor": {
        "type": "object",
        "properties": {
          "codi": {
            "type": "string"
          },
          "valor": {
            "type": "string"
          }
        }
      },
      "DominiList": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Domini"
        }
      },
      "DominiPagedList": {
        "type": "object",
        "properties": {
          "content": {
            "$ref": "#/components/schemas/DominiList"
          }
        },
        "allOf": [
          {
            "$ref": "#/components/schemas/PagedResponse"
          }
        ]
      },
      "PagedResponse": {
        "type": "object",
        "properties": {
          "pageable": {
            "$ref": "#/components/schemas/PagedResponse_pageable"
          },
          "totalPages": {
            "type": "integer",
            "format": "int32"
          },
          "last": {
            "type": "boolean"
          },
          "totalElements": {
            "type": "integer",
            "format": "int32"
          },
          "size": {
            "type": "integer",
            "format": "int32"
          },
          "number": {
            "type": "integer",
            "format": "int32"
          },
          "numberOfElements": {
            "type": "integer",
            "format": "int32"
          },
          "sort": {
            "$ref": "#/components/schemas/PagedResponse_pageable_sort"
          },
          "first": {
            "type": "boolean"
          }
        }
      },
      "PagedResponse_pageable": {
        "type": "object",
        "properties": {
          "sort": {
            "$ref": "#/components/schemas/PagedResponse_pageable_sort"
          },
          "offset": {
            "type": "integer",
            "format": "int32"
          },
          "pageNumber": {
            "type": "integer",
            "format": "int32"
          },
          "pageSize": {
            "type": "integer",
            "format": "int32"
          },
          "paged": {
            "type": "boolean"
          },
          "unpaged": {
            "type": "boolean"
          }
        }
      },
      "PagedResponse_pageable_sort": {
        "type": "object",
        "properties": {
          "sorted": {
            "type": "boolean"
          },
          "unsorted": {
            "type": "boolean"
          }
        }
      }
    },
    "parameters": {
      "DominiIdPathParam": {
        "name": "dominiId",
        "in": "path",
        "description": "Identificador del domini",
        "required": true,
        "style": "simple",
        "explode": false,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "DominiCodiPathParam": {
        "name": "codi",
        "in": "path",
        "description": "Codi del domini",
        "required": true,
        "style": "simple",
        "explode": false,
        "schema": {
          "type": "string"
        }
      },
      "EntornIdPathParam": {
        "name": "entornId",
        "in": "path",
        "description": "Identificador de l'entorn",
        "required": true,
        "style": "simple",
        "explode": false,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "ExpedientTipusIdPathParam": {
        "name": "expedientTipusId",
        "in": "path",
        "description": "Identificador del tipus d'expedient",
        "required": true,
        "style": "simple",
        "explode": false,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "EntornParam": {
        "name": "entornId",
        "in": "query",
        "description": "Identificador de l'entorn",
        "required": true,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "FiltreParam": {
        "name": "filtre",
        "in": "query",
        "description": "cadena amb format rsql per a definir el filtre a aplicar a la consulta",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "string"
        }
      },
      "GlobalParam": {
        "name": "globals",
        "in": "query",
        "description": "Iindica si ha de retornar únicament dominis globals",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "boolean"
        }
      },
      "TipusExpedientParam": {
        "name": "expedientTipusId",
        "in": "query",
        "description": "Identificador del tipus d'expedient al que pertany el domini",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "TipusExpedientPareParam": {
        "name": "expedientTipusPareId",
        "in": "query",
        "description": "Identificador del tipus d'expedient pare al que pertany el domini (en cas d\\'herència)",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "PageNumberParam": {
        "name": "page",
        "in": "query",
        "description": "número de pagina a retornar en cas de desitjar paginació",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "minimum": 0,
          "type": "integer",
          "format": "int32",
          "default": 0
        }
      },
      "PageSizeParam": {
        "name": "size",
        "in": "query",
        "description": "mida de la pàgina a retornat en cas de desitjar paginació",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "minimum": 0,
          "type": "integer",
          "format": "int32",
          "default": 25
        }
      },
      "SortParam": {
        "name": "sort",
        "in": "query",
        "description": "ordre a aplicar a la consulta",
        "required": false,
        "style": "form",
        "explode": true,
        "schema": {
          "type": "string"
        }
      }
    }
  }
}